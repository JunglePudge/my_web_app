<!DOCTYPE html>
<html>
<head>
    <title>Image Resizer</title>
    <link rel="stylesheet" type="text/css" href="/static/style.css">
    <script src="https://www.google.com/recaptcha/api.js" async defer></script>
    <script>
        function onSubmit() {
            console.log("onSubmit function called");  // Log for debugging
            grecaptcha.ready(function() {
                console.log("reCAPTCHA ready");  // Log for debugging
                grecaptcha.execute('6LfS1PIpAAAAALhxE75l96slBVpBRVyyCBpuhMRs', {action: 'submit'}).then(function(token) {
                    console.log("Token generated: ", token);  // Log for debugging
                    document.getElementById('recaptcha_token').value = token;
                    console.log("Form submitted");  // Log for debugging
                    document.getElementById('resize-form').submit();  // Submit the form after setting the token
                }).catch(function(error) {
                    console.error("Error generating reCAPTCHA token:", error);  // Log for debugging
                });
            });
        }
    </script>
</head>
<body>
    <h1>Image Resizer</h1>
    <form id="resize-form" action="/resize" method="post" enctype="multipart/form-data">
        <label for="scale">Scale:</label>
        <input type="number" id="scale" name="scale" step="0.1" required><br><br>
        <label for="file">Upload Image:</label>
        <input type="file" id="file" name="file" accept="image/png, image/jpeg" required><br><br>
        <div class="g-recaptcha" data-sitekey="6LfS1PIpAAAAALhxE75l96slBVpBRVyyCBpuhMRs"></div>
        <input type="hidden" id="recaptcha_token" name="recaptcha_token">
        <button type="button" onclick="onSubmit()">Resize</button>
    </form>
</body>
</html>
